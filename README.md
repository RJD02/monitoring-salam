# Salam Unified Monitoring Platform\n\nA comprehensive monitoring platform for Spark/Yarn applications, NFS workflow logs, and Informatica workflow hierarchies. Built with Go + HTMX for offline environments.\n\n## Features\n\n- **Real-time Spark/Yarn application monitoring**\n- **NFS workflow log monitoring with error detection** \n- **Informatica workflow hierarchy visualization**\n- **Job kill operations (Spark/Yarn)**\n- **Alerts and failure detection**\n- **Platform-wide observability dashboard**\n- **CLI tools for automation**\n\n## Architecture\n\n- **Backend**: Go 1.23+ with embedded assets\n- **Frontend**: HTMX + TailwindCSS (no build process)\n- **Database**: SQLite for local history (optional)\n- **Deployment**: Single binary, no external dependencies\n\n## Quick Start\n\n### 1. Clone and Setup\n\n```bash\ngit clone <repository>\ncd monitoring\n```\n\n### 2. Development Setup\n\n```bash\n# Setup test environment with sample data\n./setup-test-env.sh\n\n# Install dependencies\ngo mod tidy\n\n# Build application\ngo build -o salam-monitor cmd/main.go\n```\n\n### 3. Run in Test Mode\n\n```bash\n# Start server in test mode\n./salam-monitor --mode=test\n\n# Access web interface\nopen http://localhost:8080\n```\n\n### 4. CLI Usage\n\n```bash\n# View today's logs\n./salam-monitor logs today\n\n# Kill Yarn applications by pattern\n./salam-monitor yarn kill pattern=\"spark_ingest.*\"\n\n# Show workflow tree\n./salam-monitor wf tree platform=\"miniboss\"\n```\n\n## Configuration\n\n### Test Mode Configuration (`config/config.yaml`)\n\n```yaml\nmode: \"test\"\nserver:\n  port: 8080\npaths:\n  nfs_root_test: \"./nfs_backup/monitoring\"\n  nfs_root_prod: \"/home/informaticaadmin/nfs_backup/monitoring\"\nservices:\n  yarn_rm_url: \"http://localhost:8088\"\n  informatica_db:\n    host: \"localhost\"\n    service: \"TESTDB\"\n    user: \"test_user\"\n    password: \"test_pass\"\n```\n\n### Production Mode Configuration\n\n```yaml\nmode: \"prod\"\nserver:\n  port: 8080\npaths:\n  nfs_root_prod: \"/home/informaticaadmin/nfs_backup/monitoring\"\nservices:\n  yarn_rm_url: \"http://yarn-rm:8088\"\n  informatica_db:\n    host: \"172.16.1.100\"\n    service: \"INFAPROD\"\n    user: \"repo_read\"\n    password: \"SECURE_PASSWORD\"\n```\n\n## Production Deployment\n\n### 1. Build Production Binary\n\n```bash\n# Build for Linux production\nGOOS=linux GOARCH=amd64 go build -ldflags \"-s -w\" -o salam-monitor cmd/main.go\n```\n\n### 2. Deploy to Production Server\n\n```bash\n# Deploy to remote server\n./deploy.sh production-server\n\n# Or deploy locally\n./deploy.sh local\n```\n\n### 3. Systemd Service Management\n\n```bash\n# Check service status\nsudo systemctl status salam-monitor\n\n# View logs\nsudo journalctl -u salam-monitor -f\n\n# Restart service\nsudo systemctl restart salam-monitor\n```\n\n## Directory Structure\n\n```\nsalam-monitoring/\n├── cmd/\n│   └── main.go                 # Application entry point\n├── internal/\n│   ├── config/                 # Configuration handling\n│   ├── nfs/                    # NFS log scanner\n│   ├── yarn/                   # Yarn API client\n│   ├── informatica/            # Informatica DB client\n│   └── web/                    # Web server\n├── web/\n│   ├── templates/              # HTML templates\n│   └── static/                 # CSS/JS assets\n├── config/\n│   ├── config.yaml             # Test configuration\n│   └── config.prod.yaml        # Production template\n├── systemd/\n│   └── salam-monitor.service   # Systemd service file\n├── nfs_backup/                 # Test data directory\n├── deploy.sh                   # Deployment script\n├── setup-test-env.sh           # Test setup script\n└── README.md\n```\n\n## Web Interface\n\n### Dashboard\n- System overview and quick stats\n- Failed workflows summary\n- Running applications count\n- Quick action buttons\n\n### NFS Monitoring\n- Today's workflow logs\n- Error detection and highlighting\n- Log file preview and download\n- Search functionality\n\n### Yarn Applications\n- Running Spark/Yarn applications\n- Cluster metrics and resource usage\n- Bulk kill operations\n- Application filtering\n\n### Informatica Workflows\n- Workflow hierarchy visualization\n- Parent → Child → Task → Session mapping\n- Run status and history\n- Failed workflow analysis\n\n### System Health\n- CPU/Memory/Disk usage\n- Service connectivity checks\n- Recent error logs\n- Network diagnostics\n\n## CLI Commands\n\n### Log Operations\n```bash\n./salam-monitor logs today                    # Show today's logs\n./salam-monitor logs search \"error\"           # Search logs\n```\n\n### Yarn Operations\n```bash\n./salam-monitor yarn list                     # List applications\n./salam-monitor yarn kill pattern=\"prefix.*\"  # Kill by pattern\n```\n\n### Workflow Operations\n```bash\n./salam-monitor wf tree platform=\"miniboss\"   # Show workflow tree\n./salam-monitor wf status                     # Workflow status\n```\n\n## Environment Variables\n\n- `SALAM_MODE`: Override mode (test|prod)\n- `SALAM_CONFIG`: Override config file path\n- `SALAM_PORT`: Override server port\n\n## Production Requirements\n\n### Target Environment\n- RHEL 7/8/9 or equivalent\n- No internet access required\n- Access to:\n  - `/home/informaticaadmin/nfs_backup/monitoring/`\n  - Yarn Resource Manager REST API\n  - Informatica Repository Oracle DB\n\n### Resource Requirements\n- **CPU**: 2+ cores\n- **Memory**: 512MB+ RAM\n- **Disk**: 1GB+ free space\n- **Network**: Access to monitoring targets\n\n### Firewall Ports\n- **8080**: Web interface (configurable)\n- **8088**: Yarn Resource Manager API\n- **1521**: Oracle database (if applicable)\n\n## Security\n\n### Access Control\n- Internal network only\n- Binary permissions: `750`\n- Config file protection\n- Optional token-based auth\n\n### Data Protection\n- No sensitive data logging\n- Encrypted database connections\n- Read-only repository access\n\n## Monitoring & Alerts\n\n### Built-in Monitoring\n- Workflow failure detection\n- Long-running job alerts\n- Resource usage monitoring\n- Service health checks\n\n### Error Diagnostics\n- Spark error categorization\n- Broadcast timeout detection\n- OOM error detection\n- Database connection issues\n\n## Troubleshooting\n\n### Common Issues\n\n1. **Service won't start**\n   ```bash\n   sudo journalctl -u salam-monitor --no-pager\n   sudo systemctl status salam-monitor\n   ```\n\n2. **Cannot connect to Yarn**\n   - Check yarn_rm_url in config\n   - Verify network connectivity\n   - Test: `curl http://yarn-rm:8088/ws/v1/cluster/info`\n\n3. **Database connection failed**\n   - Verify Oracle connection details\n   - Check network access to database\n   - Test credentials\n\n4. **NFS logs not showing**\n   - Check nfs_root path in config\n   - Verify directory permissions\n   - Ensure log files exist\n\n### Debug Mode\n```bash\n./salam-monitor --config=config.yaml --mode=test --debug\n```\n\n### Health Check\n```bash\ncurl http://localhost:8080/health\n```\n\n## Development\n\n### Adding Features\n1. Backend logic in `internal/` packages\n2. HTML templates in `web/templates/`\n3. HTMX endpoints in web server\n4. Update tests and documentation\n\n### Testing\n```bash\n# Run tests\ngo test ./...\n\n# Setup test environment\n./setup-test-env.sh\n\n# Test build\ngo build -o salam-monitor cmd/main.go\n./salam-monitor --mode=test\n```\n\n## License\n\nInternal use only - Salam Unified Monitoring Platform\n\n## Support\n\nFor issues and feature requests, contact the monitoring team.